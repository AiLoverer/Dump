<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>CrashRpt: Configuring Your Project&#39;s Build Settings</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="style.css" rel="stylesheet" type="text/css">
<link rel="icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>

<div style="padding:10px">
<table border="0" bgcolor="#FFFFFF" cellspacing="5" width="100%">
 <tr>
  <td width="24px" rowspan="2"><img src="../logo.png" alt="Logo" /></td>
  <td><font family="Arial" size="+2">crashrpt</font></td>
  <td rowspan="2" align="right"></td>
 </tr>
 <tr>
  <td colspan="2"><span style="font-size:0.9em"><i>A crash reporting system for Windows applications</i></a></td>
 </tr>
</table>
</div>


<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Contents</span></a></li>
      <li><a href="modules.html"><span>API&nbsp;Reference</span></a></li>
      <li><a href="files.html"><span>File&nbsp;Reference</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">CrashRpt Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="using_crashrpt.html">Using CrashRpt in Your Project</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="configuring_project">Configuring Your Project's Build Settings </a></h1><h2><a class="anchor" name="link">
Include and Lib Directories</a></h2>
At this point you should have the CrashRpt source code compiled as described in <a class="el" href="compiling_crashrpt.html">Compiling CrashRpt</a>.<p>
To let your Visual C++ compiler and linker know about the location of CrashRpt include and lib files, do the following.<p>
If you use Visual Studio 2005 or 2008, open menu <em>Tools-&gt; Options</em>. Then in appeared dialog, select <em>Projects and Solutions-&gt;VC++ Directories</em>.<p>
If you use Visual Studio 2010 or 2012, open the Property Manager window, multi-select all projects in your solution and right click the selection. In the appeared dialog, open <em>Configuration Properties-&gt;VC++ Directories</em>.<p>
Finally,<p>
<ul>
<li>In the 'Show directories for' combo box, select 'Include files', then add the path to <em>&lt;CRASHRPT_HOME&gt;\include</em> directory to the list.</li><li>In the 'Show directories for' combo box, select 'Library files', then add the path to <em>&lt;CRASHRPT_HOME&gt;\lib</em> directory to the list.</li></ul>
<p>
Here <em>&lt;CRASHRPT_HOME&gt;</em> should be replaced with the actual path of the directory you unzipped CrashRpt distribution to.<p>
Before you start using CrashRpt API functions in your program, do not forget to include <a class="el" href="_crash_rpt_8h.html">CrashRpt.h</a> header file in the beginning of your code:<p>
<div class="fragment"><pre class="fragment"><span class="comment">// Include CrashRpt header</span>
<span class="preprocessor">#include "<a class="code" href="_crash_rpt_8h.html" title="Defines the interface for the CrashRpt.DLL.">CrashRpt.h</a>"</span>
</pre></div><p>
You also need to add CrashRpt LIB file to the list of input libraries for your project. In the Solution Explorer window, right-click your project and choose Properties item from the context menu. Then open <em>Configuration Properties-&gt;Linker-&gt;Input-&gt;Additional Dependencies</em> and then add <b>CrashRptXXXX.lib</b> to the list of libraries (here XXXX should be replaced with CrashRpt version number).<h2><a class="anchor" name="crtdll">
Using CRT as Multi-Threaded DLL (/MD) in Release Configuration</a></h2>
It is important that you configure your project to use C runtime libraries (CRT) as Multi-threaded DLL (/MD) for Release configuration. This is the way recommended in MSDN. See the <a class="el" href="exception_handling.html#crt_version_and_dll">Exception Handling and CRT Linkage</a> section for more information.<p>
In the Solution Explorer window, right-click your project and open project Properties. Then choose <em>Configuration Properties-&gt;C/C++-&gt;Code Generation</em>. In the <b>Runtime Library</b> field, choose <b>Multi-threaded DLL (/MD)</b>. See the figure below for example.<p>
This should be done for all projects in your solution to share single CRT DLL.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>In Debug configuration it is not important what CRT linkage you use. Typically your default debugger intercepts exceptions instead of CrashRpt in Debug configuration.</dd></dl>
<div align="center">
<img src="crtdll.png" alt="crtdll.png">
<p><strong>Multi-threaded DLL (/MD)</strong></p></div>
<h2><a class="anchor" name="crtver">
Using the Same Version of CRT for All Application Modules</a></h2>
Ensure that all modules that exist in your application use the same version of CRT. If some dependent modules were compiled using an older version of CRT, you should recompile them to ensure the single version or CRT DLL is used.<p>
For example, assume you use Visual Studio 2008 and CRT 9.0 linked as DLL, but some dependent module in your application was compiled in Visual Studio 2005 and uses CRT 8.0 linked as DLL. In such situation a CRT error in the dependent module won't be intercepted by CrashRpt, because error handlers are installed for CRT 9.0 only.<h2><a class="anchor" name="prgdb">
Enabling Program Database (/Zi, /DEBUG) in Release Configuration</a></h2>
To be able to recover the stack traces from the crash minidump, the debugger needs your application's debugging symbols (PDB files).<p>
To enable the generation of PDB files:<ol type=1>
<li>In the Solution Explorer window, right-click your project and open project Properties. Then choose Configuration Properties-&gt;C/C++-&gt;General. In the <b>Debug Information Format</b> field, choose <b>Program Database (/Zi)</b>.</li><li>Choose Configuration Properties-&gt;Linker-&gt;Debugging. In the <b>Generate Debug Info</b> field, choose <b>Yes (/DEBUG)</b>.</li></ol>
<p>
Steps 1 and 2 should be performed for all projects in your solution that support program database (EXE, DLL).<p>
The steps 1 and 2 are presented on the figures below.<p>
<div align="center">
<img src="program_database.png" alt="program_database.png">
<p><strong>Program Database (/Zi)</strong></p></div>
 <div align="center">
<img src="linker_debug_settings.png" alt="linker_debug_settings.png">
<p><strong>Enabling Debugging Information in Linker (/DEBUG)</strong></p></div>
 <h2><a class="anchor" name="disable_fpo">
Disabling Frame Pointer Omission Optimizations</a></h2>
We recommend turning off Frame Pointer Omission (FPO) optimization in release version configurations, as this optimization does not really give an appreciable gain, but greatly complicates the analysis of the dump: the /Oy compiler option makes using the debugger more difficult because the compiler suppresses frame pointer information. Moreover, in Visual Studio 2010 this optimization is disabled by default.<p>
To disable the FPO optimization:<p>
<ol type=1>
<li>In the Solution Explorer window, right-click your project and open project Properties.</li><li>Choose Configuration Properties-&gt;C/C++-&gt;Optimization.</li><li>In the <b>Omit Frame Pointers</b> field, choose <b>No (/Oy-)</b>.</li></ol>
<p>
<div align="center">
<img src="disable_fpo.png" alt="disable_fpo.png">
<p><strong>Disabling Frame Pointer Omission Optimzation (/Oy-)</strong></p></div>
 <dl class="note" compact><dt><b>Note:</b></dt><dd>If you can't afford yourself to turn the FPO optimization off, you can manage an error log file which is not affected by optimizations.</dd></dl>
<em>Further reading:</em> <a class="el" href="using_crashrpt_api.html">Using CrashRpt API</a>. </div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Fri Aug 8 16:39:13 2014 for CrashRpt by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9</small></address>
</body>
</html>
