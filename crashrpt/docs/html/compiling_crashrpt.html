<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>CrashRpt: Compiling CrashRpt</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="style.css" rel="stylesheet" type="text/css">
<link rel="icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>

<div style="padding:10px">
<table border="0" bgcolor="#FFFFFF" cellspacing="5" width="100%">
 <tr>
  <td width="24px" rowspan="2"><img src="../logo.png" alt="Logo" /></td>
  <td><font family="Arial" size="+2">crashrpt</font></td>
  <td rowspan="2" align="right"></td>
 </tr>
 <tr>
  <td colspan="2"><span style="font-size:0.9em"><i>A crash reporting system for Windows applications</i></a></td>
 </tr>
</table>
</div>


<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Contents</span></a></li>
      <li><a href="modules.html"><span>API&nbsp;Reference</span></a></li>
      <li><a href="files.html"><span>File&nbsp;Reference</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">CrashRpt Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="using_crashrpt.html">Using CrashRpt in Your Project</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="compiling_crashrpt">Compiling CrashRpt </a></h1>By default, CrashRpt archive's <b>bin</b> directory contains binary files compiled in Visual Studio 2010. These files are provided for demonstration purposes only. It is strongly recommended that you compile CrashRpt yourself using your version of Visual Studio. This is needed to ensure CrashRpt uses the same version of C run-time libraries (CRT) as your application does.<h2><a class="anchor" name="building_solution">
Building Solution</a></h2>
The top-level directory of CrashRpt distribution contains solution file for Visual Studio 2010 (<b>CrashRpt_vs2010.sln</b>). Open this solution file to compile CrashRpt in <b>Visual C++ 2010</b> or in <b>Visual C++ Express 2010</b>.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>If you use another version (not 2010) of Visual Studio, you can generate solution/project files for your version of Visual Studio using CMake. See below for instructions.</dd></dl>
To build the solution, choose the <em>Release</em> build configuration and press F7 to start building process.<p>
When build finishes, CrashRpt executable files can be found in <b>bin</b> directory, and library files can be found inside of <b>lib</b> directory. The following files are the most important:<ul>
<li><b>bin\CrashRptXXXX.dll</b> - this is the CrashRpt crash handler module;</li><li><b>bin\CrashSenderXXXX.exe</b> - this is the crash report sender module;</li><li><b>lib\CrashRptXXXX.lib</b> - this the CrashRpt import library.</li></ul>
<p>
Above, <em>XXXX</em> placeholder should be the version number of CrashRpt.<h2><a class="anchor" name="releaselib">
Debug, Release and Release LIB Configurations</a></h2>
Typically, you compile CrashRpt in <em>Release</em> configuration. In this configuration, the build produces binary files that can be used in production environment.<p>
The <em>Debug</em> configuration is used for CrashRpt debugging and should not be used for production mode. In this configuration, the build generates d-postfixed files, for example, <em>CrashRptXXXXd.dll</em>, <em>CrashSenderXXXXd.exe</em> and so on.<p>
The <em>Release LIB</em> configuration is an addition to the standard <em>Debug</em> and <em>Release</em> build configurations. Typically, you should compile CrashRpt in <em>Release</em> configuration, but the <em>Release LIB</em> configuration may be useful if you use static CRT linkage.<p>
In the <em>Release LIB</em> configuration, the build generates <em>CrashSenderXXXX.exe</em> executable file and <em>CrashRptLIB.lib</em> static library. In this configuration, <em>CrashSenderXXXX.exe</em> and <em>CrashRptLIB.lib</em> use static linkage to CRT.<h2><a class="anchor" name="cmake_build">
Generating Project Files with CMake</a></h2>
You can generate Visual Studio project files using <a href="http://www.cmake.org/">CMake</a> cross-platform make system. Although CrashRpt doesn't support operating systems other than Windows and doesn't support compilers other than Visual C++, CMake is useful, because it makes it easier to maintain multiple build configurations between different versions of Visual Studio.<p>
To generate CrashRpt solution/project files for your favorite version of Visual Studio with CMake, do the following:<p>
<ul>
<li>Download <a href="http://www.cmake.org/">CMake</a> (version 2.8 or later) and install it. This will create CMake shortcuts in All Programs menu in the Start menu.</li><li>Run CMake (cmake-gui) application. This will display the cmake-gui window.</li><li>In the <em>Where is the source code:</em> field, enter the path to your top-level directory of CrashRpt distribution. The top-level directory and its subdirectories contain CMakeLists.txt files which are CMake configuration files.</li><li>In the <em>Where to build the binaries:</em> field, enter the path to the directory where you want to generate project files. It is recommended to enter the path to your top-level directory of CrashRpt distribution here, too.</li><li>Press the <em>Configure</em> button. When prompted, select your version of Visual Studio from the list. If everything is OK, you should see the message "Configuring done".</li><li>In the option list, modify build options as you wish.<ul>
<li><em>CRASHRPT_BUILD_SHARED_LIBS</em> option controls whether to build CrashRpt as DLL or as a static LIB. It is recommended that you have this checked. Unchecking the option will force CrashRpt to build static libs instead of DLLs (this is equivalent to Release LIB build configuration).</li><li><em>CRASHRPT_LINK_CRT_AS_DLL</em> option controls how CrashRpt should be linked to C run-time (CRT) libraries. Unchecking this option will force CrashRpt to link CRT as a multi-threaded static library (this is equivalent to Release LIB build configuration). It is recommended that you have this checked, which results in linking CRT as multi-threaded DLL.</li></ul>
</li><li>After modifying the options, press the <em>Configure</em> button the second time to force changes to make effect. If everything is OK, you should see the message "Configuring done".</li><li>Press the <em>Generate</em> button. This will generate project files to the directory you have specified. If everything is OK, you should see the message "Generating done".</li><li>And finally, go to the directory you have specified in the <em>Where to build the binaries:</em> field. You should see the generated <b>CrashRpt.sln</b> file that you can use to compile CrashRpt (open it in Visual Studio).</li></ul>
<p>
<div align="center">
<img src="cmake.png" alt="cmake.png">
<p><strong>cmake-gui window</strong></p></div>
<h2><a class="anchor" name="solution_structure">
CrashRpt Solution Structure</a></h2>
There are several projects in CrashRpt solution.<p>
<div align="center">
<img src="solution_explorer.png" alt="solution_explorer.png">
<p><strong>Structure of CrashRpt solution as seen in Solution Explorer window</strong></p></div>
<p>
<ul>
<li><b>ConsoleDemo</b> is a console application that helps to test how CrashRpt works with console applications.</li></ul>
<p>
<ul>
<li><b>CrashRpt</b> project contains API implementation and provides functionality for intercepting exceptions.</li></ul>
<p>
<ul>
<li><b>CrashRptProbe</b> project contains functionality for processing error reports.</li></ul>
<p>
<ul>
<li><b>CrashSender</b> project contains functionality for displaying GUI, sending the error report and showing error report sending progress.</li></ul>
<p>
<ul>
<li><b>crprober</b> is a console tool for error reports processing.</li></ul>
<p>
<ul>
<li><b>jpeg</b> project contains JPEG file management functionality.</li></ul>
<p>
<ul>
<li><b>libogg</b> project contains OGG video container management functionality (used together with <b>libtheora</b>).</li></ul>
<p>
<ul>
<li><b>libpng</b> project contains PNG file management functionality.</li></ul>
<p>
<ul>
<li><b>libtheora</b> project contains OGG Theora video codec functionality.</li></ul>
<p>
<ul>
<li><b>MFCDemo</b> is a GUI application that helps to test that CrashRpt API functions work as expected with a MFC-based application.</li></ul>
<p>
<ul>
<li><b>minizip</b> project contains ZIP file management functionality.</li></ul>
<p>
<ul>
<li><b>Tests</b> project contains automated tests.</li></ul>
<p>
<ul>
<li><b>tinyxml</b> project contains XML file management functionality.</li></ul>
<p>
<ul>
<li><b>WTLDemo</b> is a GUI application that helps to test that CrashRpt API functions work as expected with a WTL-based application.</li></ul>
<p>
<ul>
<li><b>zlib</b> project contains file compression functionality.</li></ul>
<h2><a class="anchor" name="compiling_x64_platform">
Compilation for 64-bit (x64) Platform</a></h2>
CrashRpt can be compiled for both 32-bit (Win32) and 64-bit (x64) platforms. You can choose the current platform by opening menu Build-&gt;Configuration Manager... and by selecting the desired platform from the 'Active solution platform:' combo box.<p>
If you use CMake to generate project files, select a 64-bit compiler from the drop-down list when configuring CMake.<p>
You should have x64 compiler tools and SDK files properly installed (ensure you have checked these components during Visual C++ installation).<h2><a class="anchor" name="notes_about_evc">
Notes About Compiling in Visual C++ Express</a></h2>
Compilation in free Visual C++ Express is a little more complicated than compilation in a commercial edition of Visual C++.<p>
CrashRpt depends on WTL. WTL itself depends on Microsoft's library called ATL (Active Template Library). ATL library is a part of Visual Studio SDKs. An older version, ATL 3.0, is included into Microsoft Platform SDK for Windows Server 2003. Since then, Platform SDK was renamed into Windows SDK. However, Microsoft doesn't include ATL into Windows SDK to encourage using of commercial Visual Studio having ATL.<p>
So, there are two ways to compile CrashRpt in Visual C++ Express:<p>
<b>Recommended way.</b> Install <a href="http://www.microsoft.com/whdc/devtools/wdk/wdkpkg.mspx">Windows Driver Kit</a>, version 7.0 or later, because it contains ATL 7.1 source code. When WinDDK is installed, in VC++ Express window, open Tools-&gt;Options...-&gt;Projects and Solutions-&gt; VC++ Directories. In the 'Show directories for' combo, select 'Include files' and then add <em>C:\WinDDK\6001.18002\inc\crt\atl71</em> path to the list of include directories.<p>
<b>Alternative way.</b> You need to have Platform SDK for Windows Server 2003, because this Platform SDK contains ATL 3.0 source code. Download and install Microsoft Platform SDK for Windows Server 2003, for example <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&displaylang=en">from here</a>.<p>
In VC++ Express window, open Tools-&gt;Options...-&gt;Projects and Solutions-&gt; VC++ Directories. In the 'Show directories for' combo, select 'Include files' and then add <em>&lt;Platform_SDK_Folder&gt;\Include\atl</em> path to the list of include directories (replace the &lt;Platform_SDK_Folder&gt; with the actual directory name).<h2><a class="anchor" name="builddox">
Generating Project Documentation</a></h2>
By default, project documentation is already generated and included into the CrashRpt distribution. To open the documentation, click <code>index.html</code> file in the top-level directory of CrashRpt distribution.<p>
You can also build documentation yourself. CrashRpt documentation can be generated using the Doxygen tool. You can download the tool from <a href="http://www.stack.nl/~dimitri/doxygen/">here</a>.<p>
To build the documentation, go to the <code>docs</code> folder and type in the command line:<p>
<div class="fragment"><pre class="fragment">doxygen Doxyfile
</pre></div><p>
When doxygen finishes, go to the top level directory and open <code>index.html</code>.<p>
<em>Further reading:</em> <a class="el" href="configuring_project.html">Configuring Your Project's Build Settings</a>. </div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Fri Aug 8 16:39:13 2014 for CrashRpt by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9</small></address>
</body>
</html>
