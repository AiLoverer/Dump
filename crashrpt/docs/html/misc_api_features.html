<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>CrashRpt: Miscellaneous API Features</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="style.css" rel="stylesheet" type="text/css">
<link rel="icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>

<div style="padding:10px">
<table border="0" bgcolor="#FFFFFF" cellspacing="5" width="100%">
 <tr>
  <td width="24px" rowspan="2"><img src="../logo.png" alt="Logo" /></td>
  <td><font family="Arial" size="+2">crashrpt</font></td>
  <td rowspan="2" align="right"></td>
 </tr>
 <tr>
  <td colspan="2"><span style="font-size:0.9em"><i>A crash reporting system for Windows applications</i></a></td>
 </tr>
</table>
</div>


<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Contents</span></a></li>
      <li><a href="modules.html"><span>API&nbsp;Reference</span></a></li>
      <li><a href="files.html"><span>File&nbsp;Reference</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">CrashRpt Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="using_crashrpt.html">Using CrashRpt in Your Project</a>&nbsp;&raquo&nbsp;<a class="el" href="using_crashrpt_api.html">Using CrashRpt API</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="misc_api_features">Miscellaneous API Features </a></h1>This page covers miscellaneous API features not mentioned in previous two pages.<h2><a class="anchor" name="manual_report_generation">
Generating Error Report Manually</a></h2>
Typically CrashRpt generates error reports automatically, when a critical error occurs. But sometimes it is required to generate error report manually, on user demand.<p>
Assume it is required to remotely debug some application logics error. Such an error, for example, infinite loop in a worker thread, may not cause program crash. To collect the information about error that doesn't cause crash, a software developer might provide an ability to generate error report manually on user demand, for example on a key combination press.<p>
The <a class="el" href="group___crash_rpt_a_p_i.html#g60af60c28c64a1d3baa11f1220b9c3f4" title="Manually generates an error report.">crGenerateErrorReport()</a> function allows to generate an error report manually. When you generate an error report manually, the caller process is not terminated and continues its execution. To send the error report, CrashRpt creates another process named <em>CrashSender.exe</em>.<h2><a class="anchor" name="catching_seh_exceptions">
Catching Structured Exceptions in a Block of Code</a></h2>
Sometimes it may be required to catch a SEH exception inside of a block of code (using <code>__try/__except</code> construction) and generate error report when an exception happens. CrashRpt provides a conveniense function <a class="el" href="group___crash_rpt_a_p_i.html#gb993bf6a9e7b2f909263d8032496b4dc">crExceptionFilter()</a> for this purpose.<p>
For additional information on SEH exceptions, please refer to <a class="el" href="exception_handling.html">About Exceptions and Exception Handling</a> page.<h2><a class="anchor" name="silent_mode">
Silent (non-GUI) Mode</a></h2>
CrashRpt can function in silent (non-GUI) mode. In this mode, <em>Error Report</em> window is not displayed on crash and no interaction with user is performed. The silent mode is enabled by specifying the <a class="el" href="_crash_rpt_8h.html#eac654ac2258cdf40a907dca1617e193">CR_INST_NO_GUI</a> flag for <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#2ca0180aea2957c6698cd7c63925d33e">CR_INSTALL_INFO::dwFlags</a> structure member.<p>
The silent mode is designed for server applications or services that do not need to interact with user on crash. The silent mode should not be used for regular GUI applications. For regular interactive applications, a user should provide his/her consent to allow sending the error report.<h2><a class="anchor" name="automatic_app_restart">
Automatic Application Restart</a></h2>
You can tell CrashRpt to restart your application automatically when crash occurs. This can be done by specifying the <a class="el" href="_crash_rpt_8h.html#92c65e94c4f6f1363644114be2c49f7a">CR_INST_APP_RESTART</a> flag for the <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#2ca0180aea2957c6698cd7c63925d33e">CR_INSTALL_INFO::dwFlags</a> structure member.<p>
You can pass command line parameters to the executable being restarted using <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#5ee73cf06c84b4dd8c355bed89f1ba13">CR_INSTALL_INFO::pszRestartCmdLine</a>, but can't specify another executable for restart. Only the same executable can be restarted that was used to start the current process.<p>
By default, the application is restarted only if at least 60 seconds have elapsed since its start up. This is done to avoid cyclic restarts of an application that crashes right on its start up. (Also, the application is restarted only if the user does provide his/her consent.) You can override the default restart timeout (in seconds) using the <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#3c9b1c391dcfb5098d3c26c3db45f989">CR_INSTALL_INFO::nRestartTimeout</a> structure field.<p>
If you generate an error report manually with automatic restart feature enabled, the caller process is not terminated automatically and another instance of client application is launched. If you want to avoid starting the second instance of the client application, specify the <a class="el" href="struct_c_r___e_x_c_e_p_t_i_o_n___i_n_f_o.html#57d37a6126d85c48d692a919635af742">CR_EXCEPTION_INFO::bManual</a> flag.<h2><a class="anchor" name="customizing_ui">
Customizing CrashRpt User Interface</a></h2>
CrashRpt provides several options for customizing look and feel of its UI (Error Report Dialog and other dialogs).<p>
You can specify custom icon for CrashRpt dialogs by specifying <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#1b14ccee6aa51b55d8080d93bd5efaf0">CR_INSTALL_INFO::pszCustomSenderIcon</a> structure member. The value of this parameter should be absolute path to the module containing the icon resource, followed by resource identifier separated by comma. For example, specifying this with "C:\\WINDOWS\\System32\\user32.dll, 1" results in the following appearance (see the figure below).<p>
<div align="center">
<img src="custom_icon.png" alt="custom_icon.png">
<p><strong>Custom Icon</strong></p></div>
 By default, CrashRpt allows user to choose, whether to send error report (user clicks the "Send report" button) or exit the application (user clicks the "Exit the program" button). Hovewer, for some applications it may be useful to make sending error reports mandatory. Specifying <a class="el" href="_crash_rpt_8h.html#b677b59587b63a4c457569b638d58cb9">CR_INST_SEND_MANDATORY</a> flag for <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#2ca0180aea2957c6698cd7c63925d33e">CR_INSTALL_INFO::dwFlags</a> structure member makes sending procedure mandatory by removing the "Close" button and "Close the program" button from the Error Report dialog (as shown in the figure below). Typically, it is not recommended to use this flag, unless you intentionally want users to always send error reports for your application.<p>
<div align="center">
<img src="send_mandatory.png" alt="send_mandatory.png">
<p><strong>Sending Error Report Mandatory</strong></p></div>
 Specifying the <a class="el" href="_crash_rpt_8h.html#9873d5793ced1cd754e1a0310925f28b">CR_INST_SHOW_ADDITIONAL_INFO_FIELDS</a> flag for <a class="el" href="struct_c_r___i_n_s_t_a_l_l___i_n_f_o_a.html#2ca0180aea2957c6698cd7c63925d33e">CR_INSTALL_INFO::dwFlags</a> structure member makes "Your E-mail" and "Describe what you were doing when the problem occurred" fields of <em>Error Report</em> dialog always visible (see the figure below). By default (when this parameter not specified), these fields are hidden and user needs to click the "Provide additional info (recommended)" link to show them. You can specify this flag if you need to attract user's attention to those fields.<p>
<div align="center">
<img src="more_info_fields.png" alt="more_info_fields.png">
<p><strong>Showing User E-mail and Problem Description Fields</strong></p></div>
 <h2><a class="anchor" name="crashender_cmdline">
CrashSender.exe Command-line Options</a></h2>
The following is not a real "API feature", but a useful command-line option for <em>CrashSender.exe</em> executable.<p>
As of v.1.3.1, CrashRpt allows to specify a command line parameter <em>/terminate</em> for <em>CrashSender.exe</em>. This resolves a problem with installers that will want to update or remove the EXE file during software installation process. Earlier, there was no way to programmatically tell the <em>CrashSender.exe</em> program to exit immediatelly.<p>
Launching "CrashSender.exe /terminate" from command shell would look for all open <em>CrashSender.exe</em> processes and terminate them immediately (without sending crash reports or waiting for completion). Terminating the process is acomplished with <b>TerminateProcess()</b> function.<p>
<em>Further reading:</em> <a class="el" href="simple_example.html">An Example of Using CrashRpt API</a>. </div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Fri Aug 8 16:39:13 2014 for CrashRpt by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9</small></address>
</body>
</html>
